# Image Vectorization with Depth: convexified shape layers with depth ordering

![](..\..\论文笔记\AIGC\fig\Image Vectorization_1.png)

文章实现图像矢量化的过程大致可以分为以下几个关键步骤：

1. **颜色量化（Color Quantization）**：
   - 首先，文章使用K-means聚类算法对输入的光栅图像进行颜色量化，将图像中的颜色减少到预定数量的颜色，形成颜色量化后的图像。这一步骤简化了图像，减少了后续处理的复杂性。

2. **定义形状层（Shape Layers）**：
   - 颜色量化后的图像中，相同颜色的连通分量被定义为一个形状层（shape layer）。每个形状层对应一个颜色，并且每个形状层都是一个独立的区域。

3. **深度排序（Depth Ordering）**：
   - 通过构建一个有向图，文章提出了一个新的深度排序能量函数来确定形状层之间的相对深度顺序。这个函数基于形状层之间的覆盖面积比，用于确定一个形状层是否在另一个形状层的前面或后面。
   - 如果有向图中存在循环，使用凸包对称差（convex hull symmetric difference）能量函数来移除循环，从而获得一个线性的全局深度顺序。

4. **基于曲率的图像修复（Curvature-Based Inpainting）**：
   - 使用欧拉弹性曲线（Euler's Elastica）变分修复技术来凸化每个形状层的被遮挡区域。这个过程最小化了一个结合了弧长和曲率的弹性能量，以产生平滑的边界曲线。
   - 文章还利用了Modica-Mortola双井势能方法来稳定和有效地修复大面积的曲率。

5. **贝塞尔曲线拟合（Bézier Curve Fitting）**：
   - 对于每个凸化后的形状层，文章使用贝塞尔曲线来拟合其边界。通过提取相位转换函数的零交叉点作为离散点集，并从中识别出曲率极值点，来准确地捕捉边界的几何特征。
   - 利用最小二乘问题来拟合贝塞尔曲线，并对拟合误差进行迭代细化，直到满足预设的误差阈值。

6. **输出为SVG文件（SVG Output）**：
   - 最后，按照深度顺序将每个形状层的贝塞尔曲线写入SVG文件中。SVG格式允许形状层的叠加显示，从而实现了图像的矢量化。
