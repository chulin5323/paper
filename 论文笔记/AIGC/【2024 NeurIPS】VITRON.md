# VITRON: A Unified Pixel-level Vision LLM for Understanding, Generating, Segmenting, Editing

[PDF](..\..\AIGC\inpainting\【2024 NeurIPS】VITRON A Unified Pixel-level Vision LLM for Understanding, Generating, Segmenting, Editing.pdf) 

<img src="..\..\\论文笔记\AIGC\fig\VITRON_1.png" style="zoom:80%;" />

> 提出了名为VITRON的新型像素级视觉大型语言模型（Vision LLM），它旨在解决现有视觉大型语言模型（LLMs）在多模态通用性方面的挑战，包括粗粒度实例级理解、缺乏对图像和视频统一支持，以及在各种视觉任务中的覆盖不足。VITRON通过提供一个统一的框架来理解和生成静态图像和动态视频，从而在从低级到高级的不同视觉任务中实现广泛的应用。

1. 提出了一个能够理解、生成、分割和编辑图像和视频的像素级视觉LLM。
2. 引入了一种新的混合方法，通过离散文本指令和连续信号嵌入来确保从LLM到后端模块的精确功能调用。
3. 设计了各种像素级时空视觉-语言对齐学习，以实现最佳的细粒度视觉能力。
4. 提出了跨任务协同模块，通过最大化任务不变细粒度视觉特征的共享，增强不同视觉任务之间的协同作用。

## 以往工作存在的缺陷及解决的问题

主要是现有视觉LLMs存在的缺陷：

1. **图像和视频的分离处理**：大多数现有的视觉LLMs将**图像和视频视为独立的实体**，只支持其中之一，而没有统一的框架同时支持图像和视频。VITRON通过统一的架构同时支持这两种模态，认识到视觉天然包括静态图像和动态视频，这两者在大多数场景中是可互换的。
2. **视觉任务支持不足**：当前的MLLMs主要支持图像或视频的理解，最多支持图像或视频的生成。VITRON提出未来的MLLMs应该支持更广泛的视觉任务和功能，实现对所有视觉相关任务的统一支持，这对于实际应用尤其重要，特别是在视觉创作中，通常涉及一系列迭代和交互操作。
3. **多任务性能的最优化**：对于集成了多种多模态功能的通用模型，如何确保所有任务都能尽可能地发挥最佳性能是一个关键问题。这包括确保LLM的指令能精确传达给下游解码器，以及不同任务之间不相互削弱而是相互协作。
4. **消息传递机制的局限性**：在MLLM社区中，有两种主流的LLM到解码器的消息传递方法：基于离散文本指令的方法和基于连续信号嵌入的方法。这两种方法各有优缺点，文章提出通过整合这两种方法来弥补各自的不足。
5. **细粒度视觉理解的缺乏**：尽管一些模型已经能够进行像素级的图像理解，但在视频理解和生成方面，以及在多任务协同方面，现有的MLLMs仍然不够深入。VITRON通过提出细粒度时空视觉定位指令调整和跨任务协同学习来增强模型的像素级视觉感知能力。
6. **跨任务协同的挑战**：在集成多个视觉专家模块的通用模型中，如何实现不同模块之间的协同工作是一个关键问题。VITRON通过提出一个跨任务协同模块来解决这一挑战，该模块通过对抗训练来分离任务特定特征和任务不变的细粒度视觉特征，从而增强不同任务之间的协同效应。

## 方法

<img src="..\..\论文笔记\AIGC\fig\VITRON_2.png" style="zoom:80%;" />

<img src="..\..\论文笔记\AIGC\fig\VITRON_3.png" style="zoom:80%;" />

1. **统一的像素级视觉LLM框架**：VITRON作为一个统一的模型，能够处理从低级到高级的各种视觉任务，包括理解、生成、分割和编辑图像和视频。
2. **前端模块**：VITRON在前端集成了图像、视频和像素级区域视觉的编码器，以支持细粒度的用户视觉输入。
3. **后端模块**：VITRON在后端集成了最先进的视觉专家系统，如GLIGEN、SEEM、ZeroScope、I2VGen-XL和StableVideo，用于执行广泛的视觉任务。
4. **混合方法的消息传递**：VITRON提出了一种新的混合方法，通过同时整合离散文本指令和连续信号嵌入，以确保从LLM到后端模块的有效和精确的功能调用。
5. **像素级时空视觉-语言对齐学习**：VITRON设计了各种像素级时空视觉-语言对齐学习任务，以提高模型的细粒度视觉能力。
6. **跨任务协同模块**：VITRON引入了一个跨任务协同模块，通过**最大化任务不变的细粒度视觉特征的共享**，增强不同视觉任务之间的协同作用。
7. **对抗训练**：VITRON使用对抗训练来分离任务特定特征和任务不变的细粒度视觉特征，从而提高模型在不同任务间共享特征的能力。
8. **结构化调用模板**：VITRON设计了结构化的调用模板，包括模块名称、调用命令和区域（可选），以实现特征解耦和跨任务协同。
9. **训练策略**：VITRON的训练分为三个阶段，包括基础多模态理解和生成技能训练、细粒度时空视觉定位指令调整和跨任务协同学习。